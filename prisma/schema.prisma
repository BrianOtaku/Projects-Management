generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql" // hoáº·c "mysql"
  url      = env("DATABASE_URL")
}

enum Role {
  MANAGER
  LEADER
  STAFF
}

enum Status {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
}

model User {
  id         BigInt       @id @default(autoincrement())
  name       String
  email      String       @unique
  password   String 
  role       Role
  tasks      Task[]
  teamMember TeamMember[]
}

model TeamMember {
  id        BigInt  @id @default(autoincrement())
  user      User    @relation(fields: [userId], references: [id])
  userId    BigInt
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
  projectId BigInt

  @@unique([userId])
}

model Project {
  id           BigInt       @id @default(autoincrement())
  title        String
  description  String
  status       Status
  startDate    DateTime
  dueDate      DateTime
  progress     Float        @default(0.0)
  teamMembers  TeamMember[]
  tasks        Task[]
  fileUrl      String?
}

model Task {
  id                BigInt   @id @default(autoincrement())
  title             String
  description       String
  status            Status
  project           Project  @relation(fields: [projectId], references: [id])
  projectId         BigInt
  user              User     @relation(fields: [userId], references: [id])
  userId            BigInt
  startDate         DateTime
  dueDate           DateTime
  reviewedByLeader  Boolean  @default(false)
  completeAt        DateTime?
}
